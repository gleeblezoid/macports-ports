# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem              1.0
PortGroup               github 1.0

github.setup            pyenv pyenv 2.3.5 v
revision                0

categories              sysutils python devel
license                 MIT
maintainers             nomaintainer
supported_archs         noarch

description             Simple Python Version Management
long_description        pyenv lets you easily switch between multiple versions of Python.\
                        It is simple, unobtrusive, and follows the UNIX tradition of\
                        single-purpose tools that do one thing well.

github.tarball_from     archive
checksums               rmd160 1f115021f728bc7e8be10f8475bd16af3d74f630 \
                        sha256 075e530afe352d112a23d46ba1a3358090bb9e31e47b5caa4ab1a1f32df0cfb0 \
                        size   716231

depends_lib-append \
                        port:openssl11 \
                        port:readline \
                        port:pkgconfig \
                        port:autoconf \
                        port:sqlite3 \
                        port:xz \
                        port:zlib \
                        port:lzma \
                        port:py-pylzma

# Configure script breaks when ccache enabled, and no benefit here anyway
configure.ccache        no
configure.cmd           src/configure
configure.cppflags-append      -I${prefix}/include
configure.ldflags-append       "-L${prefix}/lib"
build.target            src

destroot {
    copy ${worksrcpath} ${destroot}${prefix}/bin/
}

post-destroot {
        set docdir ${prefix}/share/doc/${name}
        xinstall -d ${destroot}${docdir}
        xinstall -m 0644 -W ${worksrcpath} README.md \
            LICENSE ${destroot}${docdir}
    }

notes-append "
To configure your environment, add the following to your shell config file:
  export PYENV_ROOT=\"${prefix}/bin/${name}-${version}\"
  command -v pyenv >/dev/null || export PATH=\"\$PYENV_ROOT/bin:\$PATH\"
  eval \$(pyenv init -)
You may need to add pyenv to your path.
"
